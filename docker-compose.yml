---
version: '2'
services:
  common:
    build: "."
    environment:
      DATABASE_URL: postgres://postgres:eJthmx_3DOb2e-Ia3fXuEw@db:5432/postgres
      RACK_ENV: production
      NODE_ENV: production
  app:
    extends:
      service: common
    command: bundle exec puma -C config/puma.rb
    links:
    - db
    ports:
    - 3000:3000
  db:
    image: postgres
    environment:
      POSTGRES_PASSWORD: eJthmx_3DOb2e-Ia3fXuEw
  worker:
    extends:
      service: common
    links:
    - redis
    - db
    depends_on:
    - redis
    - db
    command: bundle exec rake jobs:work
